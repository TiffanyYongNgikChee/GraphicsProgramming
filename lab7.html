<!DOCTYPE html>
    <html>
        <head>
            <title>D3.js Demo</title>
            <meta charset="UTF-8">
            <!-- Include D3.js (v5) and jQuery using CDN links -->
            <script src="https://d3js.org/d3.v5.min.js"></script>
            <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

            <style type="text/css"></style>
        </head>
        <body>
            <!-- HTML Content -->
            <h1>Tiffany Yong</h1>
            <!-- JavaScript Section -->
            <script type="text/javascript">
                console.log("D3 and jQuery are successfully loaded.");
                $.getJSON("https://tinyurl.com/k4chnujx", function(data)
                {
                    //print to console
                    console.log(data);
                    //call function
                    plotCO2Data(data);
                });

                //Executed once the file has downloaded
                function plotCO2Data(data){
                    //Set up SVG size and margins
                    var margin = { top: 50, right: 50, bottom: 50, left:50},
                        width = 900 - margin.left - margin.right,
                        height = 670 - margin.top - margin.bottom;

                    //Create x and y scales for CO2 values (y-axis (integer - ppm)) and time (x-axis (integer â€“ years ago)) 
                    var y = d3.scaleLinear()
                        .domain(d3.extent(data,function(d){ return d["co2_ppmv"];}))
                        .range([height,0]); //seems backwards because svg y is down
                    var x = d3.scaleLinear()
                        .domain(d3.extent(data,function(d){ return (d["years_before_2023"]);})) //CO2 values
                        .range([0,width]);  
                    //parse the data / time
                    //var parseDate = d3.timeParse(''); //converts string to a date object day/month
                    
                    //Create axis(x and y) - specify number of ticks in the axis
                    //x us the d3.scaleTime()
                    var xAxis = d3.axisBottom(x)
                        .ticks(3);//specify the number of ticks
                    //y is the d3.scaleLinear
                    var yAxis = d3.axisLeft(y)
                        .ticks(3);//specify the number of ticks
               
                    //Create line (d3.line()) objects
                    var valueLine = d3.line() //draw line - map x,y coords for each data point using the scales
                        .x(function(d){return x(d["years_before_2023"])}) 
                        .y(function(d){return y(d["co2_ppmv"])});

                    //Append an SVG element to the webpage
                    var svg = d3.select('body')
                        .append("svg")
                            .attr("width",width + margin.left + margin.right)
                            .attr("height",height + margin.top + margin.bottom)
                        .append("g")
                        //adds an offset
                        .attr("transform","translate(" + margin.left + ","+margin.top+")");
                    
                    //add axes and the line object to the SVG
                    svg.append('g') //append a <g> - group element
                        .attr('class','x axis')
                        .attr("transform", "translate(0," + height + ")")
                        .call(xAxis); //let the axis do its thing
                    svg.append('g')
                        .attr('class','y axis') //specity classes
                        .call(yAxis);
                    svg.append("path") //Add the valueline path
                        .attr("d",valueLine(data))
                        .attr("stroke", "red") //Make the graph line red
                        .attr("stroke-width", 2)
                        .attr("fill", "none");
                    
                    svg.append("text")
                        .attr("class", "x label")
                        .attr("text-anchor", "end")
                        .attr("x", width)
                        .attr("y", height - 10)
                        .text("years ago");
                    
                    svg.append("text")
                        .attr("class", "y label")
                        .attr("text-anchor", "end")
                        .attr("y", 6)
                        .attr("dy", ".75em")
                        .attr("transform", "rotate(-90)")
                        .text("ppm");
                }
            </script>
        </body>
    </html>
